<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Euro 2024 Goals: Reversed Small Multiples + Direct Match Info</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    /* Existing styles here */
  </style>
</head>
<body>

<h1>How did Spain win the 2024 euros: A data view</h1>

<div id="storyNavigation">
  <button id="prevSlide" disabled>← Previous</button>
  <span id="slideIndicator">1 / 7</span>
  <button id="nextSlide">Next →</button>
</div>

<div id="slides">
  <div id="slide1" class="slide active">
    <h2>Goals Timeline Analysis</h2>
    <div class="narrative-section">
      <p>
        Spain's triumph in Euro 2024 marked their fourth European Championship victory, showcasing a blend of tactical brilliance and clinical finishing. 
        Their journey through the tournament was characterized by crucial goals at pivotal moments, demonstrating both their ability to control games 
        and their resilience under pressure.
      </p>
      <p>
        Let's begin by examining the timing of Spain's goals throughout the tournament, revealing patterns in their scoring and how they compared 
        to other teams. The timeline below shows when goals were scored, highlighting the moments that shaped their path to victory.
      </p>
    </div>
    <div id="controls">
      <label>Team Filter:</label>
      <select id="teamSelect"></select>

      <label>
        <input type="checkbox" id="penaltyCheck" />
        Exclude Penalty Goals
      </label>

      <label>
        <input type="checkbox" id="miniHeatCheck" />
        Heatmap in Small Multiples
      </label>
    </div>

    <div id="mainTimelineContainer">
      <svg id="goalsSvg" width="900" height="300"></svg>
      <div id="tooltip"></div>
    </div>

    <div id="smallMultiplesControls">
      <label>Sort Small Multiples by:</label>
      <select id="sortSelect">
        <option value="total">Total Goals</option>
        <option value="penalty">Penalty Goals</option>
        <option value="extraTime">Extra Time Goals</option>
        <option value="nonPenalty">Goals (Excluding Penalties)</option>
      </select>
    </div>

    <div id="teamsContainer">
      <!-- teamsSvg will be inserted here -->
    </div>

    <div id="phaseTooltip"></div>
  </div>

  <div id="slide2" class="slide">
    <h2>Shot Analysis & Outcomes</h2>
    <div class="narrative-section">
      <p>
        Another interesting thing was how Spain approached scoring goals, which is different than others and with a lot of shots and a lot of expected goals. Spain came out on top. Let's look at this comparison between Spain and other teams between the total goals, expected goals, and total shots to see how the scene was set.
      </p>
    </div>
    <div id="shotControls">
      <!-- Shot control filters and options -->
    </div>

    <div id="shotAnalysisContainer">
      <div id="pitchViz">
        <svg id="shotMapSvg" width="800" height="600"></svg>
        <div id="shotTooltip" class="tooltip"></div>
      </div>
    </div>
  </div>

  <div id="slide3" class="slide">
    <h2>Player Composition and Contributions</h2>
    <div class="narrative-section">
      <p>
       Market value of players clearly reflected a good correlation with the final standings. But talking about clear contribution with the data we have, we can say that it was not individual brilliance, but a well-structured team and well-structured tactics that led Spain to its victory.
      </p>
    </div>
    <div id="playerAnalysisContainer">
      <!-- Player analysis content -->
    </div>
  </div>
</div>

<script>
// Declare global variables
let allEvents, standings;

// Replace local file references with Google Cloud Storage URLs
const files = {
  subset: "https://storage.googleapis.com/euro2024-data/subset_euro_2024.json",
  players: "https://storage.googleapis.com/euro2024-data/euro2024_players.csv",
  bracket: "https://storage.googleapis.com/euro2024-data/euros-2024-bracket.json",
  standings: "https://storage.googleapis.com/euro2024-data/euros_standing.csv"
};

// Load subset data
console.log("Starting to load player data...");
d3.json(files.subset).then(events => {
  allEvents = events;
  console.log("Data loaded successfully:", events);
  // Initialize visualization components here
}).catch(error => {
  console.error("Error loading data:", error);
});

// Load standings data
d3.csv(files.standings).then(data => {
  standings = data; // Assign the loaded data to the variable
  console.log("Standings data loaded successfully:", standings);
}).catch(error => {
  console.error("Error loading standings data:", error);
});

// Example function that uses standings
document.getElementById("nextSlide").addEventListener("click", () => {
  if (!standings) {
    console.error("Standings data is not available yet!");
    return;
  }

  // Use standings data in your chart
  console.log("Using standings data:", standings);
});
</script>

</body>
</html>
